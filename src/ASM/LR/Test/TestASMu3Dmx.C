//==============================================================================
//!
//! \file TestASMu3Dmx.C
//!
//! \date Aug 25 2023
//!
//! \author Arne Morten Kvarving / SINTEF
//!
//! \brief Tests for structured 3D mixed LR spline FE models.
//!
//==============================================================================

#include "ASMuCube.h"

#include "gtest/gtest.h"


namespace {

const char* cubeTH_1 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t3\t3\t3\t125\t9\t8\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0 0 0 (1)\n"
  "1: [0 0 0.5 0.5 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0.25 0 0 (1)\n"
  "2: [0 0.5 0.5 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0.5 0 0 (1)\n"
  "3: [0.5 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0.75 0 0 (1)\n"
  "4: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 1 0 0 (1)\n"
  "5: [0 0 0 0.5 ] x [0 0 0.5 0.5 ] x [0 0 0 0.5 ] 0 0.25 0 (1)\n"
  "6: [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] x [0 0 0 0.5 ] 0.25 0.25 0 (1)\n"
  "7: [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] x [0 0 0 0.5 ] 0.5 0.25 0 (1)\n"
  "8: [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] x [0 0 0 0.5 ] 0.75 0.25 0 (1)\n"
  "9: [0.5 1 1 1 ] x [0 0 0.5 0.5 ] x [0 0 0 0.5 ] 1 0.25 0 (1)\n"
  "10: [0 0 0 0.5 ] x [0 0.5 0.5 1 ] x [0 0 0 0.5 ] 0 0.5 0 (1)\n"
  "11: [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] x [0 0 0 0.5 ] 0.25 0.5 0 (1)\n"
  "12: [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] x [0 0 0 0.5 ] 0.5 0.5 0 (1)\n"
  "13: [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] x [0 0 0 0.5 ] 0.75 0.5 0 (1)\n"
  "14: [0.5 1 1 1 ] x [0 0.5 0.5 1 ] x [0 0 0 0.5 ] 1 0.5 0 (1)\n"
  "15: [0 0 0 0.5 ] x [0.5 0.5 1 1 ] x [0 0 0 0.5 ] 0 0.75 0 (1)\n"
  "16: [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] x [0 0 0 0.5 ] 0.25 0.75 0 (1)\n"
  "17: [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] x [0 0 0 0.5 ] 0.5 0.75 0 (1)\n"
  "18: [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] x [0 0 0 0.5 ] 0.75 0.75 0 (1)\n"
  "19: [0.5 1 1 1 ] x [0.5 0.5 1 1 ] x [0 0 0 0.5 ] 1 0.75 0 (1)\n"
  "20: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0 1 0 (1)\n"
  "21: [0 0 0.5 0.5 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0.25 1 0 (1)\n"
  "22: [0 0.5 0.5 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0.5 1 0 (1)\n"
  "23: [0.5 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0.75 1 0 (1)\n"
  "24: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 1 1 0 (1)\n"
  "25: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0 0.5 0.5 ] 0 0 0.25 (1)\n"
  "26: [0 0 0.5 0.5 ] x [0 0 0 0.5 ] x [0 0 0.5 0.5 ] 0.25 0 0.25 (1)\n"
  "27: [0 0.5 0.5 1 ] x [0 0 0 0.5 ] x [0 0 0.5 0.5 ] 0.5 0 0.25 (1)\n"
  "28: [0.5 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0 0.5 0.5 ] 0.75 0 0.25 (1)\n"
  "29: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0 0.5 0.5 ] 1 0 0.25 (1)\n"
  "30: [0 0 0 0.5 ] x [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] 0 0.25 0.25 (1)\n"
  "31: [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] 0.25 0.25 0.25 (1)\n"
  "32: [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] 0.5 0.25 0.25 (1)\n"
  "33: [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] 0.75 0.25 0.25 (1)\n"
  "34: [0.5 1 1 1 ] x [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] 1 0.25 0.25 (1)\n"
  "35: [0 0 0 0.5 ] x [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] 0 0.5 0.25 (1)\n"
  "36: [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] 0.25 0.5 0.25 (1)\n"
  "37: [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] 0.5 0.5 0.25 (1)\n"
  "38: [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] 0.75 0.5 0.25 (1)\n"
  "39: [0.5 1 1 1 ] x [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] 1 0.5 0.25 (1)\n"
  "40: [0 0 0 0.5 ] x [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] 0 0.75 0.25 (1)\n"
  "41: [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] 0.25 0.75 0.25 (1)\n"
  "42: [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] 0.5 0.75 0.25 (1)\n"
  "43: [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] 0.75 0.75 0.25 (1)\n"
  "44: [0.5 1 1 1 ] x [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] 1 0.75 0.25 (1)\n"
  "45: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0 0.5 0.5 ] 0 1 0.25 (1)\n"
  "46: [0 0 0.5 0.5 ] x [0.5 1 1 1 ] x [0 0 0.5 0.5 ] 0.25 1 0.25 (1)\n"
  "47: [0 0.5 0.5 1 ] x [0.5 1 1 1 ] x [0 0 0.5 0.5 ] 0.5 1 0.25 (1)\n"
  "48: [0.5 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0 0.5 0.5 ] 0.75 1 0.25 (1)\n"
  "49: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0 0.5 0.5 ] 1 1 0.25 (1)\n"
  "50: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0.5 0.5 1 ] 0 0 0.5 (1)\n"
  "51: [0 0 0.5 0.5 ] x [0 0 0 0.5 ] x [0 0.5 0.5 1 ] 0.25 0 0.5 (1)\n"
  "52: [0 0.5 0.5 1 ] x [0 0 0 0.5 ] x [0 0.5 0.5 1 ] 0.5 0 0.5 (1)\n"
  "53: [0.5 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0.5 0.5 1 ] 0.75 0 0.5 (1)\n"
  "54: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0.5 0.5 1 ] 1 0 0.5 (1)\n"
  "55: [0 0 0 0.5 ] x [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] 0 0.25 0.5 (1)\n"
  "56: [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] 0.25 0.25 0.5 (1)\n"
  "57: [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] 0.5 0.25 0.5 (1)\n"
  "58: [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] 0.75 0.25 0.5 (1)\n"
  "59: [0.5 1 1 1 ] x [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] 1 0.25 0.5 (1)\n"
  "60: [0 0 0 0.5 ] x [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] 0 0.5 0.5 (1)\n"
  "61: [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] 0.25 0.5 0.5 (1)\n"
  "62: [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] 0.5 0.5 0.5 (1)\n"
  "63: [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] 0.75 0.5 0.5 (1)\n"
  "64: [0.5 1 1 1 ] x [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] 1 0.5 0.5 (1)\n"
  "65: [0 0 0 0.5 ] x [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] 0 0.75 0.5 (1)\n"
  "66: [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] 0.25 0.75 0.5 (1)\n"
  "67: [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] 0.5 0.75 0.5 (1)\n"
  "68: [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] 0.75 0.75 0.5 (1)\n"
  "69: [0.5 1 1 1 ] x [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] 1 0.75 0.5 (1)\n"
  "70: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0.5 0.5 1 ] 0 1 0.5 (1)\n"
  "71: [0 0 0.5 0.5 ] x [0.5 1 1 1 ] x [0 0.5 0.5 1 ] 0.25 1 0.5 (1)\n"
  "72: [0 0.5 0.5 1 ] x [0.5 1 1 1 ] x [0 0.5 0.5 1 ] 0.5 1 0.5 (1)\n"
  "73: [0.5 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0.5 0.5 1 ] 0.75 1 0.5 (1)\n"
  "74: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0.5 0.5 1 ] 1 1 0.5 (1)\n"
  "75: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0.5 0.5 1 1 ] 0 0 0.75 (1)\n"
  "76: [0 0 0.5 0.5 ] x [0 0 0 0.5 ] x [0.5 0.5 1 1 ] 0.25 0 0.75 (1)\n"
  "77: [0 0.5 0.5 1 ] x [0 0 0 0.5 ] x [0.5 0.5 1 1 ] 0.5 0 0.75 (1)\n"
  "78: [0.5 0.5 1 1 ] x [0 0 0 0.5 ] x [0.5 0.5 1 1 ] 0.75 0 0.75 (1)\n"
  "79: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0.5 0.5 1 1 ] 1 0 0.75 (1)\n"
  "80: [0 0 0 0.5 ] x [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] 0 0.25 0.75 (1)\n"
  "81: [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] 0.25 0.25 0.75 (1)\n"
  "82: [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] 0.5 0.25 0.75 (1)\n"
  "83: [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] 0.75 0.25 0.75 (1)\n"
  "84: [0.5 1 1 1 ] x [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] 1 0.25 0.75 (1)\n"
  "85: [0 0 0 0.5 ] x [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] 0 0.5 0.75 (1)\n"
  "86: [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] 0.25 0.5 0.75 (1)\n"
  "87: [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] 0.5 0.5 0.75 (1)\n"
  "88: [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] 0.75 0.5 0.75 (1)\n"
  "89: [0.5 1 1 1 ] x [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] 1 0.5 0.75 (1)\n"
  "90: [0 0 0 0.5 ] x [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] 0 0.75 0.75 (1)\n"
  "91: [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] 0.25 0.75 0.75 (1)\n"
  "92: [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] 0.5 0.75 0.75 (1)\n"
  "93: [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] 0.75 0.75 0.75 (1)\n"
  "94: [0.5 1 1 1 ] x [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] 1 0.75 0.75 (1)\n"
  "95: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0.5 0.5 1 1 ] 0 1 0.75 (1)\n"
  "96: [0 0 0.5 0.5 ] x [0.5 1 1 1 ] x [0.5 0.5 1 1 ] 0.25 1 0.75 (1)\n"
  "97: [0 0.5 0.5 1 ] x [0.5 1 1 1 ] x [0.5 0.5 1 1 ] 0.5 1 0.75 (1)\n"
  "98: [0.5 0.5 1 1 ] x [0.5 1 1 1 ] x [0.5 0.5 1 1 ] 0.75 1 0.75 (1)\n"
  "99: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0.5 0.5 1 1 ] 1 1 0.75 (1)\n"
  "100: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0 0 1 (1)\n"
  "101: [0 0 0.5 0.5 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0.25 0 1 (1)\n"
  "102: [0 0.5 0.5 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0.5 0 1 (1)\n"
  "103: [0.5 0.5 1 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0.75 0 1 (1)\n"
  "104: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 1 0 1 (1)\n"
  "105: [0 0 0 0.5 ] x [0 0 0.5 0.5 ] x [0.5 1 1 1 ] 0 0.25 1 (1)\n"
  "106: [0 0 0.5 0.5 ] x [0 0 0.5 0.5 ] x [0.5 1 1 1 ] 0.25 0.25 1 (1)\n"
  "107: [0 0.5 0.5 1 ] x [0 0 0.5 0.5 ] x [0.5 1 1 1 ] 0.5 0.25 1 (1)\n"
  "108: [0.5 0.5 1 1 ] x [0 0 0.5 0.5 ] x [0.5 1 1 1 ] 0.75 0.25 1 (1)\n"
  "109: [0.5 1 1 1 ] x [0 0 0.5 0.5 ] x [0.5 1 1 1 ] 1 0.25 1 (1)\n"
  "110: [0 0 0 0.5 ] x [0 0.5 0.5 1 ] x [0.5 1 1 1 ] 0 0.5 1 (1)\n"
  "111: [0 0 0.5 0.5 ] x [0 0.5 0.5 1 ] x [0.5 1 1 1 ] 0.25 0.5 1 (1)\n"
  "112: [0 0.5 0.5 1 ] x [0 0.5 0.5 1 ] x [0.5 1 1 1 ] 0.5 0.5 1 (1)\n"
  "113: [0.5 0.5 1 1 ] x [0 0.5 0.5 1 ] x [0.5 1 1 1 ] 0.75 0.5 1 (1)\n"
  "114: [0.5 1 1 1 ] x [0 0.5 0.5 1 ] x [0.5 1 1 1 ] 1 0.5 1 (1)\n"
  "115: [0 0 0 0.5 ] x [0.5 0.5 1 1 ] x [0.5 1 1 1 ] 0 0.75 1 (1)\n"
  "116: [0 0 0.5 0.5 ] x [0.5 0.5 1 1 ] x [0.5 1 1 1 ] 0.25 0.75 1 (1)\n"
  "117: [0 0.5 0.5 1 ] x [0.5 0.5 1 1 ] x [0.5 1 1 1 ] 0.5 0.75 1 (1)\n"
  "118: [0.5 0.5 1 1 ] x [0.5 0.5 1 1 ] x [0.5 1 1 1 ] 0.75 0.75 1 (1)\n"
  "119: [0.5 1 1 1 ] x [0.5 0.5 1 1 ] x [0.5 1 1 1 ] 1 0.75 1 (1)\n"
  "120: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0 1 1 (1)\n"
  "121: [0 0 0.5 0.5 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0.25 1 1 (1)\n"
  "122: [0 0.5 0.5 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0.5 1 1 (1)\n"
  "123: [0.5 0.5 1 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0.75 1 1 (1)\n"
  "124: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n"
  "[0, 0] x [0, 1] x [0, 1] (3)\n"
  "[0.5, 0.5] x [0, 1] x [0, 1] (2)\n"
  "[1, 1] x [0, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 0] x [0, 1] (3)\n"
  "[0, 1] x [0.5, 0.5] x [0, 1] (2)\n"
  "[0, 1] x [1, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 1] x [0, 0] (3)\n"
  "[0, 1] x [0, 1] x [0.5, 0.5] (2)\n"
  "[0, 1] x [0, 1] x [1, 1] (3)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (0.5, 0.5, 0.5)    {0, 1, 2, 5, 6, 7, 10, 11, 12, 25, 26, 27, 30, 31, 32, 35, 36, 37, 50, 51, 52, 55, 56, 57, 60, 61, 62}\n"
  "1 [3] : (0.5, 0, 0) x (1, 0.5, 0.5)    {2, 3, 4, 7, 8, 9, 12, 13, 14, 27, 28, 29, 32, 33, 34, 37, 38, 39, 52, 53, 54, 57, 58, 59, 62, 63, 64}\n"
  "2 [3] : (0, 0.5, 0) x (0.5, 1, 0.5)    {10, 11, 12, 15, 16, 17, 20, 21, 22, 35, 36, 37, 40, 41, 42, 45, 46, 47, 60, 61, 62, 65, 66, 67, 70, 71, 72}\n"
  "3 [3] : (0.5, 0.5, 0) x (1, 1, 0.5)    {12, 13, 14, 17, 18, 19, 22, 23, 24, 37, 38, 39, 42, 43, 44, 47, 48, 49, 62, 63, 64, 67, 68, 69, 72, 73, 74}\n"
  "4 [3] : (0, 0, 0.5) x (0.5, 0.5, 1)    {50, 51, 52, 55, 56, 57, 60, 61, 62, 75, 76, 77, 80, 81, 82, 85, 86, 87, 100, 101, 102, 105, 106, 107, 110, 111, 112}\n"
  "5 [3] : (0.5, 0, 0.5) x (1, 0.5, 1)    {52, 53, 54, 57, 58, 59, 62, 63, 64, 77, 78, 79, 82, 83, 84, 87, 88, 89, 102, 103, 104, 107, 108, 109, 112, 113, 114}\n"
  "6 [3] : (0, 0.5, 0.5) x (0.5, 1, 1)    {60, 61, 62, 65, 66, 67, 70, 71, 72, 85, 86, 87, 90, 91, 92, 95, 96, 97, 110, 111, 112, 115, 116, 117, 120, 121, 122}\n"
  "7 [3] : (0.5, 0.5, 0.5) x (1, 1, 1)    {62, 63, 64, 67, 68, 69, 72, 73, 74, 87, 88, 89, 92, 93, 94, 97, 98, 99, 112, 113, 114, 117, 118, 119, 122, 123, 124}\n";

const char* cubeTH_p =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t3\t3\t3\t64\t9\t8\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0 0 0 (1)\n"
  "1: [0 0 0.5 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0.25 0 0 (1)\n"
  "2: [0 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 0.75 0 0 (1)\n"
  "3: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0 0 0.5 ] 1 0 0 (1)\n"
  "4: [0 0 0 0.5 ] x [0 0 0.5 1 ] x [0 0 0 0.5 ] 0 0.25 0 (1)\n"
  "5: [0 0 0.5 1 ] x [0 0 0.5 1 ] x [0 0 0 0.5 ] 0.25 0.25 0 (1)\n"
  "6: [0 0.5 1 1 ] x [0 0 0.5 1 ] x [0 0 0 0.5 ] 0.75 0.25 0 (1)\n"
  "7: [0.5 1 1 1 ] x [0 0 0.5 1 ] x [0 0 0 0.5 ] 1 0.25 0 (1)\n"
  "8: [0 0 0 0.5 ] x [0 0.5 1 1 ] x [0 0 0 0.5 ] 0 0.75 0 (1)\n"
  "9: [0 0 0.5 1 ] x [0 0.5 1 1 ] x [0 0 0 0.5 ] 0.25 0.75 0 (1)\n"
  "10: [0 0.5 1 1 ] x [0 0.5 1 1 ] x [0 0 0 0.5 ] 0.75 0.75 0 (1)\n"
  "11: [0.5 1 1 1 ] x [0 0.5 1 1 ] x [0 0 0 0.5 ] 1 0.75 0 (1)\n"
  "12: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0 1 0 (1)\n"
  "13: [0 0 0.5 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0.25 1 0 (1)\n"
  "14: [0 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 0.75 1 0 (1)\n"
  "15: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0 0 0.5 ] 1 1 0 (1)\n"
  "16: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0 0.5 1 ] 0 0 0.25 (1)\n"
  "17: [0 0 0.5 1 ] x [0 0 0 0.5 ] x [0 0 0.5 1 ] 0.25 0 0.25 (1)\n"
  "18: [0 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0 0.5 1 ] 0.75 0 0.25 (1)\n"
  "19: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0 0.5 1 ] 1 0 0.25 (1)\n"
  "20: [0 0 0 0.5 ] x [0 0 0.5 1 ] x [0 0 0.5 1 ] 0 0.25 0.25 (1)\n"
  "21: [0 0 0.5 1 ] x [0 0 0.5 1 ] x [0 0 0.5 1 ] 0.25 0.25 0.25 (1)\n"
  "22: [0 0.5 1 1 ] x [0 0 0.5 1 ] x [0 0 0.5 1 ] 0.75 0.25 0.25 (1)\n"
  "23: [0.5 1 1 1 ] x [0 0 0.5 1 ] x [0 0 0.5 1 ] 1 0.25 0.25 (1)\n"
  "24: [0 0 0 0.5 ] x [0 0.5 1 1 ] x [0 0 0.5 1 ] 0 0.75 0.25 (1)\n"
  "25: [0 0 0.5 1 ] x [0 0.5 1 1 ] x [0 0 0.5 1 ] 0.25 0.75 0.25 (1)\n"
  "26: [0 0.5 1 1 ] x [0 0.5 1 1 ] x [0 0 0.5 1 ] 0.75 0.75 0.25 (1)\n"
  "27: [0.5 1 1 1 ] x [0 0.5 1 1 ] x [0 0 0.5 1 ] 1 0.75 0.25 (1)\n"
  "28: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0 0.5 1 ] 0 1 0.25 (1)\n"
  "29: [0 0 0.5 1 ] x [0.5 1 1 1 ] x [0 0 0.5 1 ] 0.25 1 0.25 (1)\n"
  "30: [0 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0 0.5 1 ] 0.75 1 0.25 (1)\n"
  "31: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0 0.5 1 ] 1 1 0.25 (1)\n"
  "32: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0 0.5 1 1 ] 0 0 0.75 (1)\n"
  "33: [0 0 0.5 1 ] x [0 0 0 0.5 ] x [0 0.5 1 1 ] 0.25 0 0.75 (1)\n"
  "34: [0 0.5 1 1 ] x [0 0 0 0.5 ] x [0 0.5 1 1 ] 0.75 0 0.75 (1)\n"
  "35: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0 0.5 1 1 ] 1 0 0.75 (1)\n"
  "36: [0 0 0 0.5 ] x [0 0 0.5 1 ] x [0 0.5 1 1 ] 0 0.25 0.75 (1)\n"
  "37: [0 0 0.5 1 ] x [0 0 0.5 1 ] x [0 0.5 1 1 ] 0.25 0.25 0.75 (1)\n"
  "38: [0 0.5 1 1 ] x [0 0 0.5 1 ] x [0 0.5 1 1 ] 0.75 0.25 0.75 (1)\n"
  "39: [0.5 1 1 1 ] x [0 0 0.5 1 ] x [0 0.5 1 1 ] 1 0.25 0.75 (1)\n"
  "40: [0 0 0 0.5 ] x [0 0.5 1 1 ] x [0 0.5 1 1 ] 0 0.75 0.75 (1)\n"
  "41: [0 0 0.5 1 ] x [0 0.5 1 1 ] x [0 0.5 1 1 ] 0.25 0.75 0.75 (1)\n"
  "42: [0 0.5 1 1 ] x [0 0.5 1 1 ] x [0 0.5 1 1 ] 0.75 0.75 0.75 (1)\n"
  "43: [0.5 1 1 1 ] x [0 0.5 1 1 ] x [0 0.5 1 1 ] 1 0.75 0.75 (1)\n"
  "44: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0 0.5 1 1 ] 0 1 0.75 (1)\n"
  "45: [0 0 0.5 1 ] x [0.5 1 1 1 ] x [0 0.5 1 1 ] 0.25 1 0.75 (1)\n"
  "46: [0 0.5 1 1 ] x [0.5 1 1 1 ] x [0 0.5 1 1 ] 0.75 1 0.75 (1)\n"
  "47: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0 0.5 1 1 ] 1 1 0.75 (1)\n"
  "48: [0 0 0 0.5 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0 0 1 (1)\n"
  "49: [0 0 0.5 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0.25 0 1 (1)\n"
  "50: [0 0.5 1 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 0.75 0 1 (1)\n"
  "51: [0.5 1 1 1 ] x [0 0 0 0.5 ] x [0.5 1 1 1 ] 1 0 1 (1)\n"
  "52: [0 0 0 0.5 ] x [0 0 0.5 1 ] x [0.5 1 1 1 ] 0 0.25 1 (1)\n"
  "53: [0 0 0.5 1 ] x [0 0 0.5 1 ] x [0.5 1 1 1 ] 0.25 0.25 1 (1)\n"
  "54: [0 0.5 1 1 ] x [0 0 0.5 1 ] x [0.5 1 1 1 ] 0.75 0.25 1 (1)\n"
  "55: [0.5 1 1 1 ] x [0 0 0.5 1 ] x [0.5 1 1 1 ] 1 0.25 1 (1)\n"
  "56: [0 0 0 0.5 ] x [0 0.5 1 1 ] x [0.5 1 1 1 ] 0 0.75 1 (1)\n"
  "57: [0 0 0.5 1 ] x [0 0.5 1 1 ] x [0.5 1 1 1 ] 0.25 0.75 1 (1)\n"
  "58: [0 0.5 1 1 ] x [0 0.5 1 1 ] x [0.5 1 1 1 ] 0.75 0.75 1 (1)\n"
  "59: [0.5 1 1 1 ] x [0 0.5 1 1 ] x [0.5 1 1 1 ] 1 0.75 1 (1)\n"
  "60: [0 0 0 0.5 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0 1 1 (1)\n"
  "61: [0 0 0.5 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0.25 1 1 (1)\n"
  "62: [0 0.5 1 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 0.75 1 1 (1)\n"
  "63: [0.5 1 1 1 ] x [0.5 1 1 1 ] x [0.5 1 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n"
  "[0, 0] x [0, 1] x [0, 1] (3)\n"
  "[0.5, 0.5] x [0, 1] x [0, 1] (1)\n"
  "[1, 1] x [0, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 0] x [0, 1] (3)\n"
  "[0, 1] x [0.5, 0.5] x [0, 1] (1)\n"
  "[0, 1] x [1, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 1] x [0, 0] (3)\n"
  "[0, 1] x [0, 1] x [0.5, 0.5] (1)\n"
  "[0, 1] x [0, 1] x [1, 1] (3)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (0.5, 0.5, 0.5)    {0, 1, 2, 4, 5, 6, 8, 9, 10, 16, 17, 18, 20, 21, 22, 24, 25, 26, 32, 33, 34, 36, 37, 38, 40, 41, 42}\n"
  "1 [3] : (0.5, 0, 0) x (1, 0.5, 0.5)    {1, 2, 3, 5, 6, 7, 9, 10, 11, 17, 18, 19, 21, 22, 23, 25, 26, 27, 33, 34, 35, 37, 38, 39, 41, 42, 43}\n"
  "2 [3] : (0, 0.5, 0) x (0.5, 1, 0.5)    {4, 5, 6, 8, 9, 10, 12, 13, 14, 20, 21, 22, 24, 25, 26, 28, 29, 30, 36, 37, 38, 40, 41, 42, 44, 45, 46}\n"
  "3 [3] : (0.5, 0.5, 0) x (1, 1, 0.5)    {5, 6, 7, 9, 10, 11, 13, 14, 15, 21, 22, 23, 25, 26, 27, 29, 30, 31, 37, 38, 39, 41, 42, 43, 45, 46, 47}\n"
  "4 [3] : (0, 0, 0.5) x (0.5, 0.5, 1)    {16, 17, 18, 20, 21, 22, 24, 25, 26, 32, 33, 34, 36, 37, 38, 40, 41, 42, 48, 49, 50, 52, 53, 54, 56, 57, 58}\n"
  "5 [3] : (0.5, 0, 0.5) x (1, 0.5, 1)    {17, 18, 19, 21, 22, 23, 25, 26, 27, 33, 34, 35, 37, 38, 39, 41, 42, 43, 49, 50, 51, 53, 54, 55, 57, 58, 59}\n"
  "6 [3] : (0, 0.5, 0.5) x (0.5, 1, 1)    {20, 21, 22, 24, 25, 26, 28, 29, 30, 36, 37, 38, 40, 41, 42, 44, 45, 46, 52, 53, 54, 56, 57, 58, 60, 61, 62}\n"
  "7 [3] : (0.5, 0.5, 0.5) x (1, 1, 1)    {21, 22, 23, 25, 26, 27, 29, 30, 31, 37, 38, 39, 41, 42, 43, 45, 46, 47, 53, 54, 55, 57, 58, 59, 61, 62, 63}\n";

const char* cubeTH_2 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
   "\t2\t2\t2\t27\t9\t8\t3\t0\n"
   "# Basis functions:\n"
   "0: [0 0 0.5 ] x [0 0 0.5 ] x [0 0 0.5 ] 0 0 0 (1)\n"
   "1: [0.5 1 1 ] x [0 0 0.5 ] x [0 0 0.5 ] 1 0 0 (1)\n"
   "2: [0 0.5 1 ] x [0 0 0.5 ] x [0 0 0.5 ] 0.5 0 0 (1)\n"
   "3: [0 0 0.5 ] x [0.5 1 1 ] x [0 0 0.5 ] 0 1 0 (1)\n"
   "4: [0.5 1 1 ] x [0.5 1 1 ] x [0 0 0.5 ] 1 1 0 (1)\n"
   "5: [0 0.5 1 ] x [0.5 1 1 ] x [0 0 0.5 ] 0.5 1 0 (1)\n"
   "6: [0 0 0.5 ] x [0 0.5 1 ] x [0 0 0.5 ] 0 0.5 0 (1)\n"
   "7: [0.5 1 1 ] x [0 0.5 1 ] x [0 0 0.5 ] 1 0.5 0 (1)\n"
   "8: [0 0.5 1 ] x [0 0.5 1 ] x [0 0 0.5 ] 0.5 0.5 0 (1)\n"
   "9: [0 0 0.5 ] x [0 0 0.5 ] x [0.5 1 1 ] 0 0 1 (1)\n"
   "10: [0.5 1 1 ] x [0 0 0.5 ] x [0.5 1 1 ] 1 0 1 (1)\n"
   "11: [0 0.5 1 ] x [0 0 0.5 ] x [0.5 1 1 ] 0.5 0 1 (1)\n"
   "12: [0 0 0.5 ] x [0.5 1 1 ] x [0.5 1 1 ] 0 1 1 (1)\n"
   "13: [0.5 1 1 ] x [0.5 1 1 ] x [0.5 1 1 ] 1 1 1 (1)\n"
   "14: [0 0.5 1 ] x [0.5 1 1 ] x [0.5 1 1 ] 0.5 1 1 (1)\n"
   "15: [0 0 0.5 ] x [0 0.5 1 ] x [0.5 1 1 ] 0 0.5 1 (1)\n"
   "16: [0.5 1 1 ] x [0 0.5 1 ] x [0.5 1 1 ] 1 0.5 1 (1)\n"
   "17: [0 0.5 1 ] x [0 0.5 1 ] x [0.5 1 1 ] 0.5 0.5 1 (1)\n"
   "18: [0 0 0.5 ] x [0 0 0.5 ] x [0 0.5 1 ] 0 0 0.5 (1)\n"
   "19: [0.5 1 1 ] x [0 0 0.5 ] x [0 0.5 1 ] 1 0 0.5 (1)\n"
   "20: [0 0.5 1 ] x [0 0 0.5 ] x [0 0.5 1 ] 0.5 0 0.5 (1)\n"
   "21: [0 0 0.5 ] x [0.5 1 1 ] x [0 0.5 1 ] 0 1 0.5 (1)\n"
   "22: [0.5 1 1 ] x [0.5 1 1 ] x [0 0.5 1 ] 1 1 0.5 (1)\n"
   "23: [0 0.5 1 ] x [0.5 1 1 ] x [0 0.5 1 ] 0.5 1 0.5 (1)\n"
   "24: [0 0 0.5 ] x [0 0.5 1 ] x [0 0.5 1 ] 0 0.5 0.5 (1)\n"
   "25: [0.5 1 1 ] x [0 0.5 1 ] x [0 0.5 1 ] 1 0.5 0.5 (1)\n"
   "26: [0 0.5 1 ] x [0 0.5 1 ] x [0 0.5 1 ] 0.5 0.5 0.5 (1)\n"
   "# Mesh rectangles:\n"
   "[0, 0] x [0, 1] x [0, 1] (2)\n"
   "[0.5, 0.5] x [0, 1] x [0, 1] (1)\n"
   "[1, 1] x [0, 1] x [0, 1] (2)\n"
   "[0, 1] x [0, 0] x [0, 1] (2)\n"
   "[0, 1] x [0.5, 0.5] x [0, 1] (1)\n"
   "[0, 1] x [1, 1] x [0, 1] (2)\n"
   "[0, 1] x [0, 1] x [0, 0] (2)\n"
   "[0, 1] x [0, 1] x [0.5, 0.5] (1)\n"
   "[0, 1] x [0, 1] x [1, 1] (2)\n"
   "# Elements:\n"
   "0 [3] : (0, 0, 0) x (0.5, 0.5, 0.5)    {0, 2, 6, 8, 18, 20, 24, 26}\n"
   "1 [3] : (0.5, 0, 0) x (1, 0.5, 0.5)    {1, 2, 7, 8, 19, 20, 25, 26}\n"
   "2 [3] : (0, 0.5, 0) x (0.5, 1, 0.5)    {3, 5, 6, 8, 21, 23, 24, 26}\n"
   "3 [3] : (0.5, 0.5, 0) x (1, 1, 0.5)    {4, 5, 7, 8, 22, 23, 25, 26}\n"
   "4 [3] : (0, 0, 0.5) x (0.5, 0.5, 1)    {9, 11, 15, 17, 18, 20, 24, 26}\n"
   "5 [3] : (0.5, 0, 0.5) x (1, 0.5, 1)    {10, 11, 16, 17, 19, 20, 25, 26}\n"
   "6 [3] : (0, 0.5, 0.5) x (0.5, 1, 1)    {12, 14, 15, 17, 21, 23, 24, 26}\n"
   "7 [3] : (0.5, 0.5, 0.5) x (1, 1, 1)    {13, 14, 16, 17, 22, 23, 25, 26}\n";

const char* cubeFRTH_1 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t3\t3\t3\t27\t6\t1\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 0 1 ] x [0 0 0 1 ] x [0 0 0 1 ] 0 0 0 (1)\n"
  "1: [0 0 1 1 ] x [0 0 0 1 ] x [0 0 0 1 ] 0.5 0 0 (1)\n"
  "2: [0 1 1 1 ] x [0 0 0 1 ] x [0 0 0 1 ] 1 0 0 (1)\n"
  "3: [0 0 0 1 ] x [0 0 1 1 ] x [0 0 0 1 ] 0 0.5 0 (1)\n"
  "4: [0 0 1 1 ] x [0 0 1 1 ] x [0 0 0 1 ] 0.5 0.5 0 (1)\n"
  "5: [0 1 1 1 ] x [0 0 1 1 ] x [0 0 0 1 ] 1 0.5 0 (1)\n"
  "6: [0 0 0 1 ] x [0 1 1 1 ] x [0 0 0 1 ] 0 1 0 (1)\n"
  "7: [0 0 1 1 ] x [0 1 1 1 ] x [0 0 0 1 ] 0.5 1 0 (1)\n"
  "8: [0 1 1 1 ] x [0 1 1 1 ] x [0 0 0 1 ] 1 1 0 (1)\n"
  "9: [0 0 0 1 ] x [0 0 0 1 ] x [0 0 1 1 ] 0 0 0.5 (1)\n"
  "10: [0 0 1 1 ] x [0 0 0 1 ] x [0 0 1 1 ] 0.5 0 0.5 (1)\n"
  "11: [0 1 1 1 ] x [0 0 0 1 ] x [0 0 1 1 ] 1 0 0.5 (1)\n"
  "12: [0 0 0 1 ] x [0 0 1 1 ] x [0 0 1 1 ] 0 0.5 0.5 (1)\n"
  "13: [0 0 1 1 ] x [0 0 1 1 ] x [0 0 1 1 ] 0.5 0.5 0.5 (1)\n"
  "14: [0 1 1 1 ] x [0 0 1 1 ] x [0 0 1 1 ] 1 0.5 0.5 (1)\n"
  "15: [0 0 0 1 ] x [0 1 1 1 ] x [0 0 1 1 ] 0 1 0.5 (1)\n"
  "16: [0 0 1 1 ] x [0 1 1 1 ] x [0 0 1 1 ] 0.5 1 0.5 (1)\n"
  "17: [0 1 1 1 ] x [0 1 1 1 ] x [0 0 1 1 ] 1 1 0.5 (1)\n"
  "18: [0 0 0 1 ] x [0 0 0 1 ] x [0 1 1 1 ] 0 0 1 (1)\n"
  "19: [0 0 1 1 ] x [0 0 0 1 ] x [0 1 1 1 ] 0.5 0 1 (1)\n"
  "20: [0 1 1 1 ] x [0 0 0 1 ] x [0 1 1 1 ] 1 0 1 (1)\n"
  "21: [0 0 0 1 ] x [0 0 1 1 ] x [0 1 1 1 ] 0 0.5 1 (1)\n"
  "22: [0 0 1 1 ] x [0 0 1 1 ] x [0 1 1 1 ] 0.5 0.5 1 (1)\n"
  "23: [0 1 1 1 ] x [0 0 1 1 ] x [0 1 1 1 ] 1 0.5 1 (1)\n"
  "24: [0 0 0 1 ] x [0 1 1 1 ] x [0 1 1 1 ] 0 1 1 (1)\n"
  "25: [0 0 1 1 ] x [0 1 1 1 ] x [0 1 1 1 ] 0.5 1 1 (1)\n"
  "26: [0 1 1 1 ] x [0 1 1 1 ] x [0 1 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n"
  "[0, 0] x [0, 1] x [0, 1] (3)\n"
  "[1, 1] x [0, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 0] x [0, 1] (3)\n"
  "[0, 1] x [1, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 1] x [0, 0] (3)\n"
  "[0, 1] x [0, 1] x [1, 1] (3)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (1, 1, 1)    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26}\n";

const char* cubeRT_1 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t3\t2\t2\t12\t6\t1\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 0 1 ] x [0 0 1 ] x [0 0 1 ] 0 0 0 (1)\n"
  "1: [0 0 1 1 ] x [0 0 1 ] x [0 0 1 ] 0.5 0 0 (1)\n"
  "2: [0 1 1 1 ] x [0 0 1 ] x [0 0 1 ] 1 0 0 (1)\n"
  "3: [0 0 0 1 ] x [0 1 1 ] x [0 0 1 ] 0 1 0 (1)\n"
  "4: [0 0 1 1 ] x [0 1 1 ] x [0 0 1 ] 0.5 1 0 (1)\n"
  "5: [0 1 1 1 ] x [0 1 1 ] x [0 0 1 ] 1 1 0 (1)\n"
  "6: [0 0 0 1 ] x [0 0 1 ] x [0 1 1 ] 0 0 1 (1)\n"
  "7: [0 0 1 1 ] x [0 0 1 ] x [0 1 1 ] 0.5 0 1 (1)\n"
  "8: [0 1 1 1 ] x [0 0 1 ] x [0 1 1 ] 1 0 1 (1)\n"
  "9: [0 0 0 1 ] x [0 1 1 ] x [0 1 1 ] 0 1 1 (1)\n"
  "10: [0 0 1 1 ] x [0 1 1 ] x [0 1 1 ] 0.5 1 1 (1)\n"
  "11: [0 1 1 1 ] x [0 1 1 ] x [0 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n[0, 0] x [0, 1] x [0, 1] (3)\n"
  "[1, 1] x [0, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 0] x [0, 1] (2)\n"
  "[0, 1] x [1, 1] x [0, 1] (2)\n"
  "[0, 1] x [0, 1] x [0, 0] (2)\n"
  "[0, 1] x [0, 1] x [1, 1] (2)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (1, 1, 1)    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}\n";

const char* cubeRT_2 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t2\t3\t2\t12\t6\t1\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 1 ] x [0 0 0 1 ] x [0 0 1 ] 0 0 0 (1)\n"
  "1: [0 1 1 ] x [0 0 0 1 ] x [0 0 1 ] 1 0 0 (1)\n"
  "2: [0 0 1 ] x [0 0 1 1 ] x [0 0 1 ] 0 0.5 0 (1)\n"
  "3: [0 1 1 ] x [0 0 1 1 ] x [0 0 1 ] 1 0.5 0 (1)\n"
  "4: [0 0 1 ] x [0 1 1 1 ] x [0 0 1 ] 0 1 0 (1)\n"
  "5: [0 1 1 ] x [0 1 1 1 ] x [0 0 1 ] 1 1 0 (1)\n"
  "6: [0 0 1 ] x [0 0 0 1 ] x [0 1 1 ] 0 0 1 (1)\n"
  "7: [0 1 1 ] x [0 0 0 1 ] x [0 1 1 ] 1 0 1 (1)\n"
  "8: [0 0 1 ] x [0 0 1 1 ] x [0 1 1 ] 0 0.5 1 (1)\n"
  "9: [0 1 1 ] x [0 0 1 1 ] x [0 1 1 ] 1 0.5 1 (1)\n"
  "10: [0 0 1 ] x [0 1 1 1 ] x [0 1 1 ] 0 1 1 (1)\n"
  "11: [0 1 1 ] x [0 1 1 1 ] x [0 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n[0, 0] x [0, 1] x [0, 1] (2)\n"
  "[1, 1] x [0, 1] x [0, 1] (2)\n"
  "[0, 1] x [0, 0] x [0, 1] (3)\n"
  "[0, 1] x [1, 1] x [0, 1] (3)\n"
  "[0, 1] x [0, 1] x [0, 0] (2)\n"
  "[0, 1] x [0, 1] x [1, 1] (2)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (1, 1, 1)    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}\n";

const char* cubeRT_3 =
  "# LRSPLINE VOLUME\n"
  "#\tp1\tp2\tp3\tNbasis\tNline\tNel\tdim\trat\n"
  "\t2\t2\t3\t12\t6\t1\t3\t0\n"
  "# Basis functions:\n"
  "0: [0 0 1 ] x [0 0 1 ] x [0 0 0 1 ] 0 0 0 (1)\n"
  "1: [0 1 1 ] x [0 0 1 ] x [0 0 0 1 ] 1 0 0 (1)\n"
  "2: [0 0 1 ] x [0 1 1 ] x [0 0 0 1 ] 0 1 0 (1)\n"
  "3: [0 1 1 ] x [0 1 1 ] x [0 0 0 1 ] 1 1 0 (1)\n"
  "4: [0 0 1 ] x [0 0 1 ] x [0 0 1 1 ] 0 0 0.5 (1)\n"
  "5: [0 1 1 ] x [0 0 1 ] x [0 0 1 1 ] 1 0 0.5 (1)\n"
  "6: [0 0 1 ] x [0 1 1 ] x [0 0 1 1 ] 0 1 0.5 (1)\n"
  "7: [0 1 1 ] x [0 1 1 ] x [0 0 1 1 ] 1 1 0.5 (1)\n"
  "8: [0 0 1 ] x [0 0 1 ] x [0 1 1 1 ] 0 0 1 (1)\n"
  "9: [0 1 1 ] x [0 0 1 ] x [0 1 1 1 ] 1 0 1 (1)\n"
  "10: [0 0 1 ] x [0 1 1 ] x [0 1 1 1 ] 0 1 1 (1)\n"
  "11: [0 1 1 ] x [0 1 1 ] x [0 1 1 1 ] 1 1 1 (1)\n"
  "# Mesh rectangles:\n"
  "[0, 0] x [0, 1] x [0, 1] (2)\n"
  "[1, 1] x [0, 1] x [0, 1] (2)\n"
  "[0, 1] x [0, 0] x [0, 1] (2)\n"
  "[0, 1] x [1, 1] x [0, 1] (2)\n"
  "[0, 1] x [0, 1] x [0, 0] (3)\n"
  "[0, 1] x [0, 1] x [1, 1] (3)\n"
  "# Elements:\n"
  "0 [3] : (0, 0, 0) x (1, 1, 1)    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}\n";

}


class TestASMu3Dmx : public testing::Test,
                     public testing::WithParamInterface<int>
{
};


TEST_P(TestASMu3Dmx, WriteFRTH)
{
  ASMmxBase::Type = GetParam() == 0 ? ASMmxBase::FULL_CONT_RAISE_BASIS1
                                    : ASMmxBase::FULL_CONT_RAISE_BASIS2;
  ASMbase::resetNumbering();
  ASMmxuCube pch1({1,1});
  EXPECT_TRUE(pch1.generateFEMTopology());

  std::stringstream str;
  EXPECT_TRUE(pch1.write(str, 1));
  EXPECT_EQ(str.str(), GetParam() == 0 ? cubeFRTH_1 : ASMuCube::cube);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 2));
  EXPECT_EQ(str.str(), GetParam() == 1 ? cubeFRTH_1 : ASMuCube::cube);

  EXPECT_FALSE(pch1.write(str, 3));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::GEOMETRY_BASIS));
  EXPECT_EQ(str.str(), ASMuCube::cube);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::PROJECTION_BASIS));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  EXPECT_FALSE(pch1.write(str, ASM::PROJECTION_BASIS_2));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::REFINEMENT_BASIS));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::INTEGRATION_BASIS));
  EXPECT_EQ(str.str(), ASMuCube::cube);
}


TEST(TestASMu3Dmx, WriteRT)
{
  ASMmxBase::Type = ASMmxBase::DIV_COMPATIBLE;
  ASMbase::resetNumbering();
  ASMmxuCube pch1({1,1,1});
  EXPECT_TRUE(pch1.generateFEMTopology());

  std::stringstream str;
  EXPECT_TRUE(pch1.write(str, 1));
  EXPECT_EQ(str.str(), cubeRT_1);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 2));
  EXPECT_EQ(str.str(), cubeRT_2);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 3));
  EXPECT_EQ(str.str(), cubeRT_3);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 4));
  EXPECT_EQ(str.str(), ASMuCube::cube);

  EXPECT_FALSE(pch1.write(str, 5));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::GEOMETRY_BASIS));
  EXPECT_EQ(str.str(), ASMuCube::cube);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::PROJECTION_BASIS));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  EXPECT_FALSE(pch1.write(str, ASM::PROJECTION_BASIS_2));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::REFINEMENT_BASIS));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::INTEGRATION_BASIS));
  EXPECT_EQ(str.str(), ASMuCube::cube);
}


TEST(TestASMu3Dmx, WriteSG)
{
  ASMmxBase::Type = ASMmxBase::SUBGRID;
  ASMbase::resetNumbering();
  ASMmxuCube pch1({1,1});
  EXPECT_TRUE(pch1.generateFEMTopology());

  std::stringstream str;
  EXPECT_TRUE(pch1.write(str, 1));
  EXPECT_EQ(str.str(), cubeTH_p);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 2));
  EXPECT_EQ(str.str(), ASMuCube::cube);

  EXPECT_FALSE(pch1.write(str, 3));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::GEOMETRY_BASIS));
  EXPECT_EQ(str.str(), cubeTH_p);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::PROJECTION_BASIS));
  EXPECT_EQ(str.str(), cubeTH_p);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::PROJECTION_BASIS_2));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::REFINEMENT_BASIS));
  EXPECT_EQ(str.str(), cubeFRTH_1);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::INTEGRATION_BASIS));
  EXPECT_EQ(str.str(), cubeTH_p);
}


TEST_P(TestASMu3Dmx, WriteTH)
{
  ASMmxBase::Type = GetParam() == 0 ? ASMmxBase::REDUCED_CONT_RAISE_BASIS1
                                    : ASMmxBase::REDUCED_CONT_RAISE_BASIS2;
  ASMbase::resetNumbering();
  ASMmxuCube pch1({1,1});
  EXPECT_TRUE(pch1.uniformRefine(0, 1));
  EXPECT_TRUE(pch1.uniformRefine(1, 1));
  EXPECT_TRUE(pch1.uniformRefine(2, 1));
  EXPECT_TRUE(pch1.generateFEMTopology());

  std::stringstream str;
  EXPECT_TRUE(pch1.write(str, 1));
  EXPECT_EQ(str.str(), GetParam() == 0 ? cubeTH_1 : cubeTH_2);

  str.str("");
  EXPECT_TRUE(pch1.write(str, 2));
  EXPECT_EQ(str.str(), GetParam() == 1 ? cubeTH_1 : cubeTH_2);

  EXPECT_FALSE(pch1.write(str, 3));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::GEOMETRY_BASIS));
  EXPECT_EQ(str.str(), cubeTH_2);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::PROJECTION_BASIS));
  EXPECT_EQ(str.str(), cubeTH_p);

  EXPECT_FALSE(pch1.write(str, ASM::PROJECTION_BASIS_2));

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::REFINEMENT_BASIS));
  EXPECT_EQ(str.str(), cubeTH_p);

  str.str("");
  EXPECT_TRUE(pch1.write(str, ASM::INTEGRATION_BASIS));
  EXPECT_EQ(str.str(), cubeTH_2);
}


INSTANTIATE_TEST_SUITE_P(TestASMu3Dmx, TestASMu3Dmx, testing::Values(0,1));
